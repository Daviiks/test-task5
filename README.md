# Практическое задание по тестированию №5. Вариант 14.

Считайте в переменные tr_mcc_codes, tr_types, transactions и customers_gender_train из одноимённых таблиц из папки data. 
В transactions считайте только первые 1000000 строк. Соедините transactions со всеми остальными таблицами (tr_mcc_codes, tr_types, gender_train).\
Причём с customers_gender_train необходимо смёрджиться с помощью left join, а с оставшимися датафреймами – через inner (в результате соединения датафреймов должно получиться 999584 строки). Из всех типов транзакций оставьте только отрицательные суммы прихода на карту (отрицательные суммы по столбцу amount). Из поля tr_datetime выделите час tr_hour, в который произошла транзакция, как первые 2 цифры до ":". \
После этого постройте сводную таблицу, значениями в которой является пол gender, индексы – tr_hour, столбцы – amount_bucket.\
Пояснение: для строки "0 10:23:26" час будет равен 10, а для строки "6 07:08:31" – 07. Можно воспользоваться функциями str.find() и .apply(lambda x: x[]).\
Отрисуйте полученные результаты, передав их в функцию plot_pivot_table.\
Проверьте действительно ли:\
ночные поступления денег (01-05 часов) в более чем 85% случаев являются женскими;\
самые низкие траты в 3 часа ночи осуществляются в более 70% случаев женщинами.\
